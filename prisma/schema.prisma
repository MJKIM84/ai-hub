generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "sqlite"
}

model Service {
  id           String   @id @default(cuid())
  slug         String   @unique
  url          String   @unique
  name         String
  description  String?
  tagline      String?
  logoUrl      String?
  faviconUrl   String?
  ogImageUrl   String?

  category     String
  tags         String   @default("[]")
  pricingModel String   @default("free")

  clicks       Int      @default(0)
  upvotes      Int      @default(0)
  score        Float    @default(0)

  isVerified   Boolean  @default(false)
  isKorean     Boolean  @default(false)
  submittedBy  String?

  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  reviews      Review[]
  votes        Vote[]

  @@index([category])
  @@index([score])
  @@index([createdAt])
  @@index([isKorean])
}

model Review {
  id         String   @id @default(cuid())
  serviceId  String
  service    Service  @relation(fields: [serviceId], references: [id], onDelete: Cascade)
  rating     Int
  content    String?
  authorName String?

  createdAt  DateTime @default(now())

  @@index([serviceId])
}

model Vote {
  id        String   @id @default(cuid())
  serviceId String
  service   Service  @relation(fields: [serviceId], references: [id], onDelete: Cascade)
  voterIp   String
  type      String

  createdAt DateTime @default(now())

  @@unique([serviceId, voterIp, type])
  @@index([serviceId])
}
